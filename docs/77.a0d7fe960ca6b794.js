"use strict";(self.webpackChunkadminportal=self.webpackChunkadminportal||[]).push([[77],{1077:(w,C,g)=>{g.d(C,{P4:()=>T,Ye:()=>b});var p=g(7582),n=g(8256);let f=(()=>{class a{constructor(e){this.opt=e,this.dataTableChanged=new n.vpe,e&&this._setDataTable(e.dataTable,e.firstRowIsData)}send(){void 0!==this.query&&this.query.send(e=>{this.setDataTable(e.getDataTable()),this.opt.queryCallback&&this.opt.queryCallback(e)})}init(e){e&&(this.opt=e),void 0!==this.tid&&(window.clearInterval(this.tid),this.tid=void 0),this.opt.dataSourceUrl?(this.query=new google.visualization.Query(this.opt.dataSourceUrl),this.opt.query&&this.query.setQuery(this.opt.query),void 0!==this.opt.timeout&&this.query.setTimeout(this.opt.timeout),this.opt.refreshInterval&&(this.tid=window.setInterval(()=>{this.send()},1e3*this.opt.refreshInterval)),this.send()):this.setDataTable(this.opt.dataTable)}getDataTable(){return this.dataTable}setDataTable(e,t){void 0===t&&(t=this.opt.firstRowIsData),this._setDataTable(e,t),this.dataTableChanged.emit(this.dataTable)}_setDataTable(e,t){Array.isArray(e)&&(e=google.visualization.arrayToDataTable(e,t)),this.dataTable=e,this.reformat()}reformat(){const e=this.dataTable;if(void 0!==e&&void 0!==this.opt.formatters)for(const t of this.opt.formatters){let o;if("PatternFormat"===t.type){const i=t.options;o=new google.visualization.PatternFormat(i.pattern),o.format(e,t.columns,i.dstColumnIndex);continue}const r=google.visualization[t.type],s=t.options;if(o=new r(s),"ColorFormat"===t.type&&s){const i=s;if(i.ranges)for(const l of i.ranges)typeof l.fromBgColor<"u"&&typeof l.toBgColor<"u"?o.addGradientRange(l.from,l.to,l.color,l.fromBgColor,l.toBgColor):o.addRange(l.from,l.to,l.color,l.bgcolor)}for(const i of t.columns)o.format(e,i)}}}return a.\u0275fac=function(e){n.$Z()},a.\u0275dir=n.lG2({type:a,outputs:{dataTableChanged:"dataTableChanged"}}),a})(),v=(()=>{class a{constructor(e){this.el=e}setPosition(e,t){this.el.nativeElement.style.left=e+a.PIXELS,this.el.nativeElement.style.top=t+a.PIXELS}getDOMElement(){return this.el}}return a.PIXELS="px",a})(),m=(()=>{class a{constructor(e,t){this.googleChartsSettings=t,this.loadedPackages=[],this.loaded=!1,this.googleChartsSettings=Object.assign(Object.assign({},{googleChartsVersion:"50",language:e}),this.googleChartsSettings),this.googleScriptLoadingNotifier=new n.vpe,this.googleChartLoadingNotifier=new n.vpe,this.googleScriptIsLoading=!1,this.googleChartIsLoading=!1,this.loadGoogleChartsScriptPromise=new Promise((r,s)=>{if(typeof google<"u"&&google.charts)r();else if(this.googleScriptIsLoading)this.googleScriptLoadingNotifier.subscribe(i=>{i?r():s()});else{this.googleScriptIsLoading=!0;const i=document.createElement("script");i.type="text/javascript",i.src="https://www.gstatic.com/charts/loader.js",i.async=!0,i.defer=!0,i.onload=()=>{this.googleScriptIsLoading=!1,this.googleScriptLoadingNotifier.emit(!0),r()},i.onerror=()=>{this.googleScriptIsLoading=!1,this.googleScriptLoadingNotifier.emit(!1),s()},document.getElementsByTagName("head")[0].appendChild(i)}})}load(e){return(0,p.mG)(this,void 0,void 0,function*(){yield this.loadGoogleChartsScriptPromise,yield new Promise(t=>{this.googleChartIsLoading?this.googleChartLoadingNotifier.subscribe(()=>{this.doLoad(t,e)}):this.doLoad(t,e)})})}doLoad(e,t){if(!(t=Object.assign(Object.assign({},this.googleChartsSettings),t)).packages&&this.loaded)return void e();if(t.packages){let r=t.packages.filter(s=>this.loadedPackages.indexOf(s)<0);if(0==r.length&&this.loaded)return void e();t.packages=r}const o=t;o.callback=()=>{this.googleChartIsLoading=!1,void 0!==o.packages&&(this.loadedPackages=this.loadedPackages.concat(o.packages)),this.loaded=!0,this.googleChartLoadingNotifier.emit(),e()},this.googleChartIsLoading=!0,google.charts.load(t.googleChartsVersion,o)}}return a.\u0275fac=function(e){return new(e||a)(n.LFG(n.soG),n.LFG("googleChartsSettings",8))},a.\u0275prov=n.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})(),T=(()=>{class a{constructor(e,t){this.el=e,this.loaderService=t,this.selectListener=()=>{const o={message:"select",row:null,column:null,selectedRowValues:[],selectedRowFormattedValues:[],columnLabel:""},r=this.wrapper.visualization.getSelection(),s=r[r.length-1];if(!s)return o.message="deselect",o;const i=s;if(null!=s.row){o.row=i.row;const l=[],d=[],u=this.wrapper.getDataTable(),y=u.getNumberOfColumns();for(let c=0;c<y;c++)l.push(u.getValue(i.row,c)),d.push(u.getFormattedValue(i.row,c));o.selectedRowValues=l,o.selectedRowFormattedValues=d}return null!=i.column&&(o.column=i.column,o.columnLabel=this.getColumnLabelAtPosition(i)),s.name&&(o.columnLabel=s.name),o},this.chartSelect=new n.vpe,this.chartSelectOneTime=new n.vpe,this.chartReady=new n.vpe,this.chartReadyOneTime=new n.vpe,this.chartError=new n.vpe,this.chartErrorOneTime=new n.vpe,this.mouseOver=new n.vpe,this.mouseOverOneTime=new n.vpe,this.mouseOut=new n.vpe,this.mouseOutOneTime=new n.vpe,this.regionClick=new n.vpe,this.regionClickOneTime=new n.vpe}ngOnInit(){this.HTMLel=this.el.nativeElement.querySelector("div"),Object.isExtensible(this.data)&&(this.data.component=this),this.options=this.data.options,this.init().then(()=>{this.draw()})}init(){return(0,p.mG)(this,void 0,void 0,function*(){yield this.loaderService.load(),this.recreateWrapper()})}recreateWrapper(){if(void 0===this.wrapper||this.wrapper.getChartType()!==this.data.chartType){this.dataTable=new f(this.data),this.dataTable.dataTableChanged.subscribe(t=>{this._draw()});let e=this.data;if(this.data.firstRowIsData&&(e=Object.assign(e,this.data),e.dataTable=this.dataTable.getDataTable()),this.wrapper=new google.visualization.ChartWrapper(e),this.registerChartWrapperEvents(),void 0===e.dataTable&&void 0===e.dataSourceUrl)try{this.wrapper.draw(this.HTMLel)}catch{}}}_draw(){return(0,p.mG)(this,void 0,void 0,function*(){const e=this.dataTable.getDataTable();void 0!==e&&(this.convertOptions(),this.recreateWrapper(),this.wrapper.setOptions(this.options),this.wrapper.setDataTable(e),this.wrapper.draw(this.HTMLel))})}getDataTable(){return this.dataTable}draw(e){void 0===e&&(e=this.data),this.options=e.options,this.dataTable.init(e)}getSelectorBySeriesType(e){return{bars:"bar#%s#%r",haxis:"hAxis#0#label",line:"point#%s#%r",legend:"legendentry#%s",area:"point#%s#%r"}[e]}getSeriesByColumn(e){let t=0;const o=this.wrapper.getDataTable();for(let r=e-1;r>=0;r--){const s=o.getColumnRole(r),i=o.getColumnType(r);("data"===s||"number"===i)&&t++}return t}getBoundingBoxForItem(e){let t={top:0,left:0,width:0,height:0};if(this.cli){const o=e.column,r=this.getSeriesByColumn(o),s=e.row;let i=this.options.seriesType;if(this.options.series&&this.options.series[r]&&this.options.series[r].type&&(i=this.options.series[r].type),i){let l=this.getSelectorBySeriesType(i);if(l){l=l.replace("%s",r+"").replace("%c",o+"").replace("%r",s+"");const d=this.cli.getBoundingBox(l);d&&(t=d)}}}return t}getValueAtPosition(e){return null==e.row?null:this.wrapper.getDataTable().getValue(e.row,e.column)}getColumnTypeAtPosition(e){return this.wrapper.getDataTable().getColumnType(e.column)||""}getColumnLabelAtPosition(e){return this.wrapper.getDataTable().getColumnLabel(e.column)||""}getHTMLTooltip(){const e=new n.SBq(this.el.nativeElement.querySelector(".google-visualization-tooltip"));return new v(e)}parseMouseEvent(e){const t=this.wrapper.getChartType();let o=e.column;null==o&&(o="Timeline"===t?3===this.wrapper.getDataTable().getNumberOfColumns()?0:1:0);const s={row:e.row,column:o};return{position:e,boundingBox:this.getBoundingBoxForItem(s),value:this.getValueAtPosition(s),columnType:this.getColumnTypeAtPosition(s),columnLabel:this.getColumnLabelAtPosition(s)}}registerChartEvents(){const e=this.wrapper.getChart();this.cli=e.getChartLayoutInterface?e.getChartLayoutInterface():null,this.mouseOver.observers.length>0&&google.visualization.events.addListener(e,"onmouseover",t=>{const o=this.parseMouseEvent(t);o.tooltip=this.getHTMLTooltip(),this.mouseOver.emit(o)}),this.mouseOverOneTime.observers.length>0&&google.visualization.events.addOneTimeListener(e,"onmouseover",t=>{const o=this.parseMouseEvent(t);o.tooltip=this.getHTMLTooltip(),this.mouseOverOneTime.emit(o)}),this.mouseOut.observers.length>0&&google.visualization.events.addListener(e,"onmouseout",t=>{const o=this.parseMouseEvent(t);this.mouseOut.emit(o)}),this.mouseOutOneTime.observers.length>0&&google.visualization.events.addOneTimeListener(e,"onmouseout",t=>{const o=this.parseMouseEvent(t);this.mouseOutOneTime.emit(o)}),"GeoChart"===this.data.chartType&&(this.regionClick.observers.length>0&&google.visualization.events.addListener(e,"regionClick",t=>{this.regionClick.emit(t)}),this.regionClickOneTime.observers.length>0&&google.visualization.events.addOneTimeListener(e,"regionClick",t=>{this.regionClick.emit(t)}))}registerChartWrapperEvents(){google.visualization.events.addListener(this.wrapper,"ready",()=>{this.chartReady.emit({message:"Chart ready"})}),google.visualization.events.addOneTimeListener(this.wrapper,"ready",()=>{this.chartReadyOneTime.emit({message:"Chart ready (one time)"}),this.registerChartEvents()}),google.visualization.events.addListener(this.wrapper,"error",e=>{this.chartError.emit(e)}),google.visualization.events.addOneTimeListener(this.wrapper,"error",e=>{this.chartErrorOneTime.emit(e)}),this.addListener(this.wrapper,"select",this.selectListener,this.chartSelect),this.addOneTimeListener(this.wrapper,"select",this.selectListener,this.chartSelectOneTime)}addListener(e,t,o,r){google.visualization.events.addListener(e,t,()=>{r.emit(o())})}addOneTimeListener(e,t,o,r){google.visualization.events.addOneTimeListener(e,t,()=>{r.emit(o())})}convertOptions(){try{this.options=google.charts[this.data.chartType].convertOptions(this.options)}catch{return}}}return a.\u0275fac=function(e){return new(e||a)(n.Y36(n.SBq),n.Y36(m))},a.\u0275cmp=n.Xpm({type:a,selectors:[["google-chart"]],inputs:{data:"data"},outputs:{chartReady:"chartReady",chartReadyOneTime:"chartReadyOneTime",chartError:"chartError",chartErrorOneTime:"chartErrorOneTime",chartSelect:"chartSelect",chartSelectOneTime:"chartSelectOneTime",mouseOver:"mouseOver",mouseOverOneTime:"mouseOverOneTime",mouseOut:"mouseOut",mouseOutOneTime:"mouseOutOneTime",regionClick:"regionClick",regionClickOneTime:"regionClickOneTime"},decls:1,vars:0,template:function(e,t){1&e&&n._UZ(0,"div")},encapsulation:2}),a})(),b=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=n.oAB({type:a}),a.\u0275inj=n.cJS({providers:[m]}),a})()}}]);